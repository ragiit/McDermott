import{_ as e}from"./_tslib-6e8ca86b.js";import{b as t}from"./browser-f8f6e902.js";import o from"./adaptivedropdowncomponents-f3140da3.js";import{D as s}from"./dx-dropdown-base3-f5255a3e.js";import{ListBoxSelectedItemsChangedEvent as r}from"./dx-listbox-7c3bec2e.js";import{C as i}from"./custom-events-helper-e7f279d3.js";import{c as n}from"./constants-8a482032.js";import{k as d}from"./key-fa0d8a82.js";import{d as p}from"./dom-e3fa5208.js";import{E as a}from"./eventhelper-8570b930.js";import{e as l}from"./property-d3853089.js";import"./dropdowncomponents-ded2561b.js";import"./dropdown-ab547cbd.js";import"./popup-8c57c71b.js";import"./layouthelper-1d804c8c.js";import"./point-e4ec110e.js";import"./constants-58283e53.js";import"./rafaction-bba7928b.js";import"./transformhelper-ebad0156.js";import"./positiontracker-d7595cd2.js";import"./branch-bf06b0d2.js";import"./custom-element-267f9a21.js";import"./lit-element-70cf14f4.js";import"./capturemanager-89a507c8.js";import"./dispatcheraction-19309c7b.js";import"./logicaltreehelper-99f1adf9.js";import"./portal-9686dca9.js";import"./data-qa-utils-8be7c726.js";import"./constants-058ebb50.js";import"./dx-html-element-pointer-events-helper-56caf6d3.js";import"./devices-23bcdfad.js";import"./dx-ui-element-db9e89a3.js";import"./lit-element-base-7a85dca5.js";import"./nameof-factory-64d95f5b.js";import"./dx-keyboard-navigator-87f4e439.js";import"./focus-utils-6f61e33c.js";import"./touch-167bb2e4.js";import"./common-eb095e4d.js";import"./disposable-d2c2d283.js";import"./dom-utils-bc96e95b.js";import"./css-classes-f45f6949.js";import"./thumb-3dd919b6.js";import"./query-44b9267f.js";import"./popupportal-baf3cf8a.js";import"./events-interseptor-e0b24870.js";import"./modalcomponents-e42d5139.js";import"./masked-input-7db35cf2.js";import"./text-editor-9dfdefa1.js";import"./single-slot-element-base-4ab30292.js";import"./input-2c71d10c.js";class m extends CustomEvent{constructor(e,t,o,s){super(m.eventName,{detail:new h(e,t,o,s),bubbles:!0,composed:!0,cancelable:!0})}}m.eventName=n+".keydown";class c extends CustomEvent{constructor(e){super(c.eventName,{detail:new u(e),bubbles:!0,composed:!0,cancelable:!0})}}c.eventName=n+".keyup";class h{constructor(e,t,o,s){this.Key=e,this.AltKey=t,this.CtrlKey=o,this.Text=s}}class u{constructor(e){this.Key=e}}var b;i.register(m.eventName,(e=>e.detail)),i.register(c.eventName,(e=>e.detail)),function(e){e.ContentOrEditorWidth="contentoreditorwidth",e.ContentWidth="contentwidth",e.EditorWidth="editorwidth"}(b||(b={}));class f extends s{constructor(){super(),this.boundOnDropDownSelectedItemsChangedHandler=this.onDropDownSelectedItemsChanged.bind(this),this.boundOnPointerUpHandler=this.onPointerUp.bind(this),this.tabKeyPressed=!1,this.dropDownWidthMode=b.ContentOrEditorWidth,this.filteringEnabled=!1,this.dropDownWidthSourceResizeObserver=new ResizeObserver(this.onDropDownWidthSourceSizeChanged.bind(this))}get useMobileFocusBehaviour(){return t.Browser.MobileUI||super.useMobileFocusBehaviour}get shouldProcessFocusOut(){if(!this.enabled||this.isReadOnly)return!1;return!(this.editBoxTemplateElement&&this.inputElement&&!p.DomUtils.isItParent(this.editBoxTemplateElement,this.inputElement))}disconnectedCallback(){this.dropDownWidthSourceResizeObserver.disconnect(),super.disconnectedCallback()}updated(e){super.updated(e),e.has("dropDownWidthMode")&&this.prepareDropDownWidth()}connectedOrContentChanged(){super.connectedOrContentChanged(),this.dropDownWidthSourceResizeObserver.observe(this)}contentChanged(){super.contentChanged(),t.Browser.Firefox&&this.addEventListener("pointerup",this.boundOnPointerUpHandler)}processKeyDownServerCommand(e){if(!this.requireSendKeyCommandToServer(e))return super.processKeyDownServerCommand(e);return this.dispatchEvent(new m(e.key,e.altKey,e.ctrlKey||e.metaKey,this.fieldElement?this.fieldElementValue:this.fieldText)),!0}processKeyDown(e){return e.keyCode===d.KeyCode.Tab&&(this.tabKeyPressed=!0),super.processKeyDown(e)}processKeyUp(e){return e.keyCode!==d.KeyCode.Up&&e.keyCode!==d.KeyCode.Down||this.dispatchEvent(new c(e.key)),this.tabKeyPressed=!1,!1}raiseFocusOut(e){super.raiseFocusOut(e,this.tabKeyPressed)}onTextInput(e){this.inputElement&&(!this.isDropDownOpen&&e.data&&e.data.length>0&&this.toggleDropDownVisibility(),this.filteringEnabled&&(e.stopPropagation(),this.raiseFieldText()))}onTextChange(e){}onDropDownSelectedItemsChanged(e){e.stopPropagation();const t=e.target;null==t||t.scrollToFocusedItem(!1)}onDropDownWidthSourceSizeChanged(e,t){if(e.length<1||!this.dropDownElement)return;const o=e[0].target.getBoundingClientRect().width+"px";this.dropDownElement.desiredWidth=this.dropDownWidthMode===b.EditorWidth?o:null,this.dropDownElement.minDesiredWidth=this.dropDownWidthMode===b.ContentOrEditorWidth?o:null}ensurePopupElement(){var e;super.ensurePopupElement(),null===(e=this.popupElement)||void 0===e||e.addEventListener(r.eventName,this.boundOnDropDownSelectedItemsChangedHandler)}disposePopupElement(){var e;null===(e=this.popupElement)||void 0===e||e.removeEventListener(r.eventName,this.boundOnDropDownSelectedItemsChangedHandler),super.disposePopupElement()}prepareDropDownWidth(){if(this.isDOMAttached)switch(this.dropDownWidthSourceResizeObserver.disconnect(),this.dropDownElement&&(this.dropDownElement.desiredWidth=null,this.dropDownElement.minDesiredWidth=null),this.dropDownWidthMode){case b.EditorWidth:case b.ContentOrEditorWidth:this.dropDownWidthSourceResizeObserver.observe(this)}}requireSendKeyCommandToServer(e){switch(e.keyCode){case d.KeyCode.Enter:case d.KeyCode.Esc:case d.KeyCode.Up:case d.KeyCode.Down:case d.KeyCode.PageUp:case d.KeyCode.PageDown:return!0;case d.KeyCode.Home:case d.KeyCode.End:return e.ctrlKey||e.metaKey}return!1}applyTextPropertyCore(){this.fieldElement&&(super.applyTextPropertyCore(),""===this.fieldText||this.allowInput||this.fieldElement.setSelectionRange(0,0))}processFocusOut(e){if(t.Browser.Firefox&&this.needPreventFocusOutEvent)return e.preventDefault(),void(this.needPreventFocusOutEvent=!1);super.processFocusOut(e)}processPointerDown(e){return t.Browser.Firefox&&e.target&&p.DomUtils.isItParent(this.editBoxTemplateElement,e.target)&&(this.needPreventFocusOutEvent=!0),a.containsInComposedPath(e,this.isEditBoxElement.bind(this))&&!this.isDropDownOpen&&this.toggleDropDownVisibility(),super.processPointerDown(e)}onPointerUp(e){var o;t.Browser.Firefox&&(this.needPreventFocusOutEvent=!1,e.target&&p.DomUtils.isItParent(this.editBoxTemplateElement,e.target)&&(null===(o=this.editBoxElement)||void 0===o||o.focus()))}}e([l({type:b,attribute:"dropdown-width-mode"})],f.prototype,"dropDownWidthMode",void 0),e([l({type:Boolean,attribute:"filtering-enabled"})],f.prototype,"filteringEnabled",void 0),customElements.define("dxbl-combobox",f);const w={loadModule:function(){},adaptiveDropdownComponents:o};export{f as DxComboBox,w as default};
